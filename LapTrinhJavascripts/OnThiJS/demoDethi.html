<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<style>
    table,th,tr,td{
        border: 2px solid green;
        border-collapse: collapse;
        text-align: center;
        
    }

    th{
        background-color: lightgray;
    }

    #tongSoTien{
        display: none;
    }

    #thanhToan{
        display: none;
    }
</style>
<body>
    <h3>Họ và tên: Nguyễn Đình Tú</h3>
    <h3>Mã số: PD11491</h3>
    <h1>Danh mục hàng hoá</h1>
    <table border="1">
        <tr>
            <th>Số thứ tự</th>
            <th>Tên sản phẩm</th>
            <th>Giá sản phẩm</th>
            <th>Thêm</th>
        </tr>
        <tr>
            <td class="stt">1</td>
            <td>Quần áo</td>
            <td class="dongia">210,000</td>
            <td><button onclick="them(this)">+</button></td>
        </tr>
        <tr>
            <td class="stt">2</td>
            <td>Giày dép</td>
            <td class="dongia">300,000</td>
            <td><button onclick="them(this)">+</button></td>
        </tr>
        <tr>
            <td class="stt">3</td>
            <td>Mắt kính</td>
            <td class="dongia">400,000</td>
            <td><button onclick="them(this)">+</button></td>
        </tr>
        <tr>
            <td class="stt">4</td>
            <td>Quần xì</td>
            <td class="dongia">50,000</td>
            <td><button onclick="them(this)">+</button></td>
        </tr>
    </table>
    <br><br>
    <h1>Giỏ hàng của bạn</h1>

    <table id="gioHang"></table>

    <h2 id="tongSoTien">Tổng số tiền</h2>

    <button onclick="tinhTien()" id="thanhToan">Thanh toán ngay</button>

    <script>
        //truy cập đến các id giỏ hàng, tổng tiền và thanh toán
        var gioHang = document.getElementById("gioHang");
        var tongSoTien = document.getElementById("tongSoTien");
        var thanhToan = document.getElementById("thanhToan");

        //hàm để thêm sản phẩm
        function them(obj){
            //sao chép hàng trong danh mục hàng hoá
            var row = obj.parentNode.parentNode.cloneNode(true);
            
            //đưa hàng vừa sao chép vào giỏ hàng
            gioHang.appendChild(row);

            //gọi hàm để chỉnh sửa giỏ hàng
            chinhSuaGioHang();
        }

        //hàm chỉnh sửa giỏ hàng
        function chinhSuaGioHang(){
            //tạo biến để cộng dồn tổng tiền
            var tong = 0;

            //truy cập đến các dòng trong giỏ hàng
            var rows = gioHang.children;
            
            //dùng vòng lặp để lặp các dòng 
            for(let i = 0;i < rows.length;i++){
                //chỉnh sửa số thứ tự
                rows[i].getElementsByClassName("stt")[0].innerHTML = "" + (i+1);
            
                //chỉnh sửa dấu + thành dấu -
                rows[i].getElementsByTagName("button")[0].innerHTML = "-";

                //chỉnh sửa thành hàm xoá
                rows[i].getElementsByTagName("button")[0].setAttribute("onclick","xoa(this)");

                //cộng dồn tổng tiền 
                tong += Number(rows[i].getElementsByClassName("dongia")[0].innerHTML.replaceAll(",",""));
            }
            //hiển thị tổng tiền và nút thanh toán
            tongSoTien.innerHTML = "Tổng tiền là : "+ tong.toLocaleString() + "VNĐ";

            //giỏ hàng bị xoá hết thì dấu tổng tiền và nút thanh toán
            if(rows.length === 0){
                tongSoTien.style.display = "none";
                thanhToan.style.display = "none";
            }
            else{
                tongSoTien.style.display = "block";
                thanhToan.style.display = "block";
            }
        }

        //dùng hàm xoá
        function xoa(obj){
            //xác định dòng cần xoá
            var row = obj.parentNode.parentNode;

            //xoá dựa theo id giỏ hàng
            gioHang.removeChild(row);

            //cập nhật giỏ hàng
            chinhSuaGioHang();
        }

        //tạo hàm xác nhận thanh toán
        function tinhTien(){
            //tạo xác nhận
            var dongY = confirm("Bạn có xác nhận đặt hàng không?");

            //xét xác nhận
            while(gioHang.children.length > 0){
                //xác định dòng đầu tiên
                var hangDauTien = gioHang.children[0];

                //xoá toàn bộ dựa theo id giỏ hàng
                gioHang.removeChild(hangDauTien);
            }
            //ẩn tổng tiền và nút thanh toán
            tongSoTien.style.display = "none";
            thanhToan.style.display = "none";
        }
    </script>
</body>
</html>